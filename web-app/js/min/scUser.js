isc.ClassFactory.defineClass("SmartUser").addClassProperties({changePasswordDialog:function(b){var a=[];b.username?a.add({name:"username",title:isc.i18nMessages["springSecurity.login.username.label"],value:b.username,canEdit:!1,disabled:!0,canFocus:!1}):a.add({name:"password",title:isc.i18nMessages["springSecurity.login.password.label"],type:"password",required:!0,canFocus:!0});a.add({name:"password_new",title:isc.i18nMessages["springSecurity.expired.newpsw"],type:"password",required:!0,canFocus:!0});
a.add({name:"password_new_2",title:isc.i18nMessages["springSecurity.expired.newpsw2"],type:"password",required:!0,canFocus:!0,validators:[{type:"matchesField",otherField:"password_new",errorMessage:isc.i18nMessages["springSecurity.expired.errors.notMatch"]}]});a.add({name:"spacer",editorType:"RowSpacerItem"});var e=!0;b.expired&&(e="false",a.add({name:"expired",type:"boolean",value:!0,defaultValue:!0,visible:!1}),a.add({name:"expiredUser",type:"text",value:b.expiredUser,visible:!1}),App.get.user=
SmartUser.create({username:b.expiredUser}));var d={};a.add({name:"executeBtn",type:"button",canFocus:!0,colSpan:2,canEdit:null,title:isc.i18nMessages["springSecurity.expired.header"],autoFit:!0,showButtonTitle:!0,icon:"[SKIN]/custom/change_password.png",click:function(){if(this.form.validate()){var a=this;App.dataRequest(App.userChangePwdUrl,this.form.getValues(),function(f,g){var c=g.response;switch(c.status){case -1:isc.warn(c.data);break;case -4:c.errors?a.form.setErrors(c.errors,!0):isc.warn(c.data);
break;default:0>c.status?isc.warn(f.httpResponseText||c.data):b.username&&b.username!=App.get.user.username?isc.say(isc.i18nMessages["smartsfs.operation.success.default.message"].messageArgs(isc.i18nMessages["springSecurity.expired.header"])):App.get.loginUser(e),d.close(),d.markForDestroy()}},!0)}}});a=isc.DynamicForm.create({autoFocus:!0,wrapItemTitles:!1,padding:10,fields:a});d=isc.Window.create({isModal:!0,headerIconDefaults:{width:16,height:14,src:"[SKIN]/custom/change_password_mini.png"},showModalMask:!0,
autoCenter:!0,autoSize:!0,canDragResize:!0,showFooter:!0,showMinimizeButton:!1,canDragReposition:!0,canDragResize:!0,showCloseButton:void 0!=b.canClose?b.canClose:!0,title:isc.i18nMessages["springSecurity.expired.header"],items:[a],autoDraw:!0})}}).addProperties({id:null,username:"",enabled:!1,accountExpired:!0,accountLocked:!0,passwordExpired:!0,name:"",surname:"",titlename:"",email:"",lang:"",country:"",authorities:[],hasAnyRole:function(b){if(0<this.authorities.length){b=b.split(",");for(var a=
0;a<b.length;a++)if(-1<this.authorities.indexOf(b[a]))return!0}return!1},init:function(b){this.Super("init",arguments);null!=this.lang&&!isc.isA.String(this.lang)&&this.lang.hasOwnProperty("id")&&(this.lang=this.lang.id);isc.isA.Array(this.authorities)&&(this.authorities=this.authorities.map(function(a){return a.hasOwnProperty("authority")?a.authority:a}));delete this.password;delete this["class"];delete this.version;this.titlename=null==this.name&&null==this.surname?this.username:(null!=this.name?
this.name+" ":"")+this.surname}});
